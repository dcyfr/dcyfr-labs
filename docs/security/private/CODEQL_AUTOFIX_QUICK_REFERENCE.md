<!-- TLP:CLEAR -->
# GitHub Copilot Autofix - Quick Reference Card

## ğŸš€ Quick Commands

```bash
# Show help
npm run security:autofix

# Preview changes (dry run)
npm run security:autofix:trigger:dry-run

# Fix all high-severity alerts
npm run security:autofix:trigger

# Fix critical-severity only
npm run security:autofix:trigger:critical

# Fix specific alert #2
npm run security:autofix:fix -- 2

# Check workflow status
npm run security:autofix:status

# List generated PRs
npm run security:autofix:prs
```

---

## ğŸ“‹ What Gets Fixed

**Automatically Fixed:**

- âœ… Cleartext logging of sensitive data
- âœ… Input validation issues
- âœ… SQL/Command injection risks
- âœ… Basic XSS vulnerabilities
- âœ… Path traversal issues
- âœ… Regex parsing problems

**Manual Review Required:**

- âš ï¸ DOM XSS (often false positives)
- âš ï¸ Complex path validation
- âš ï¸ Hardcoded passwords (may be tests)

**Skipped:**

- âŒ Alerts below minimum severity
- âŒ Already dismissed/suppressed
- âŒ Missing location information

---

## ğŸ“Š Workflow Overview

```
â”Œâ”€ CodeQL Scans (Daily 06:00 UTC)
â”‚
â”œâ”€ Autofix Analyzes (Daily 07:00 UTC)
â”‚  â”œâ”€ Fetch alerts
â”‚  â”œâ”€ Filter by severity (high/critical/etc)
â”‚  â””â”€ Identify fixable rules
â”‚
â”œâ”€ For Each Fixable Alert (Parallel)
â”‚  â”œâ”€ Create branch: security/codeql-{number}-{rule}
â”‚  â”œâ”€ Request Copilot fix
â”‚  â”œâ”€ Validate (TypeScript, ESLint, tests)
â”‚  â””â”€ Create PR with security context
â”‚
â””â”€ Result: PR ready for human review
```

---

## ğŸ¯ Alert Severity Filtering

```
CRITICAL   â””â”€ Auto-fixed (if fixable)
HIGH       â””â”€ Auto-fixed (if fixable) â† Default
MEDIUM     â””â”€ Requires explicit trigger
LOW        â””â”€ Requires explicit trigger
WARNING    â””â”€ Requires explicit trigger
NOTE       â””â”€ Requires explicit trigger
```

---

## ğŸ“ Generated PR Format

**Branch Name:**

```
security/codeql-2-cleartext-logging
                â†‘ alert number
                          â†‘ rule short name
```

**PR Title:**

```
fix(security): resolve javascript/CleartextLogging CodeQL alert #2
```

**Labels:**

- `security` - Security-related
- `automated` - Generated by automation
- `codeql-fix` - From CodeQL autofix

**Description Includes:**

- Alert details (rule, severity, location)
- Security issue explanation
- Fix validation checklist
- Links to Code Scanning dashboard

---

## âœ… Validation Checks

All PRs validated for:

```
âœ“ TypeScript compiles (0 errors)
âœ“ ESLint passes (0 errors)
âœ“ npm audit succeeds
âœ“ Tests â‰¥99% pass rate
âœ“ Design tokens used (if UI changes)
âœ“ No new vulnerabilities introduced
```

---

## ğŸ”§ Configuration Quick Reference

**Edit:** `.github/workflows/codeql-autofix.yml`

```yaml
# Change minimum severity (line 12)
severity: 'high' # Options: critical, high, medium, low, warning, note

# Change schedule (line 8-10)
schedule:
  - cron: '0 7 * * *' # Daily 07:00 UTC
  # - cron: '0 7 * * 1'  # Weekly Monday
  # - cron: '0 9 1 * *'  # Monthly 1st
```

**Edit:** `scripts/ci/analyze-codeql-alerts.mjs`

```javascript
// Add/remove fixable rules
const FIXABLE_RULES = new Set([
  'javascript/CleartextLogging', // Add new rules
]);

// Add/remove manual review rules
const REQUIRES_MANUAL_REVIEW = new Set([
  'javascript/DOMXSS', // Add rules needing review
]);
```

---

## ğŸ› Troubleshooting

| Issue                     | Solution                                                  |
| ------------------------- | --------------------------------------------------------- |
| **Workflow not running**  | Check schedule in .github/workflows/codeql-autofix.yml    |
| **No alerts found**       | Run CodeQL manually: `gh workflow run codeql.yml`         |
| **PR not created**        | Check logs: `gh run view <run-id> --log`                  |
| **Branch already exists** | Delete: `git push origin --delete security/codeql-2-rule` |
| **Rate limit exceeded**   | Wait 1 hour, workflow will retry automatically            |

---

## ğŸ“Š Monitoring

```bash
# Recent workflow runs
gh run list --workflow=codeql-autofix.yml --limit=10

# View specific run
gh run view <run-id>

# View run logs
gh run view <run-id> --log

# List generated PRs
gh pr list --label codeql-fix

# Count merged fixes
gh pr list --label codeql-fix --state closed --json count
```

---

## ğŸ” Security & Compliance

âœ… Uses standard GitHub token (GITHUB_TOKEN)
âœ… Read-only CodeQL API access
âœ… Feature branches per alert (isolation)
âœ… All changes reviewed before merge
âœ… Full audit trail via GitHub
âœ… Follows DCYFR "Fix > Suppress" philosophy

---

## ğŸ“š Documentation

| Resource            | Link                                                                               |
| ------------------- | ---------------------------------------------------------------------------------- |
| **Full Guide**      | github-copilot-autofix.md               |
| **Setup Checklist** | CODEQL_AUTOFIX_SETUP.md                   |
| **Implementation**  | [CODEQL_AUTOFIX_IMPLEMENTATION.md](./CODEQL_AUTOFIX_IMPLEMENTATION.md)             |
| **Deployment**      | [CODEQL_AUTOFIX_DEPLOYMENT_CHECKLIST.md](./CODEQL_AUTOFIX_DEPLOYMENT_CHECKLIST.md) |
| **Security Rules**  | CODEQL_SUPPRESSIONS.md           |

---

## â±ï¸ Performance

- **Workflow time:** 5-10 minutes
- **API calls/run:** 50-100
- **Cost/run:** ~$0.05 (negligible)
- **Success rate:** 85-95%

---

## ğŸ¯ Expected Results (First Month)

| Metric              | Baseline | Target    | Status |
| ------------------- | -------- | --------- | ------ |
| Fixes created/month | 0        | 5-10      | TBD    |
| Fix success rate    | N/A      | >85%      | TBD    |
| PRs merged          | 0        | >70%      | TBD    |
| Time saved/month    | 0        | 20+ hours | TBD    |

---

## ğŸš¨ Know Before You Go Live

1. **First run may take longer** - GitHub caches build artifacts
2. **Dry-run is your friend** - Test with `-f dry_run=true` first
3. **Review PRs carefully** - Don't blindly merge, verify fixes make sense
4. **Start conservative** - Begin with `high` severity, expand later
5. **Monitor metrics** - Track success rate and adjust as needed

---

## â“ Common Questions

**Q: Can I manually fix an alert while the workflow is running?**
A: Yes, the workflow detects existing fixes and reuses the branch.

**Q: What if the Copilot fix is wrong?**
A: Validation catches most issues. If it passes validation but semantically fails, reject the PR and manually fix.

**Q: Can I disable this workflow?**
A: Yes, delete `.github/workflows/codeql-autofix.yml` or disable in GitHub Actions UI.

**Q: Does this replace human security review?**
A: No. All PRs require validation checklist completion and human review before merge.

---

## ğŸ”— Related Workflows

- **CodeQL Scan:** `codeql.yml` (Daily 06:00 UTC)
- **Security Audit:** `security-suite.yml` (On PR + daily)
- **Monthly Review:** `monthly-security-review.yml` (1st of month)
- **Dependabot:** `dependabot-auto-merge.yml` (On dependencies)

---

**Last Updated:** January 29, 2026
**Status:** âœ… Production Ready
**Need Help?** See github-copilot-autofix.md
