# Mark stale issues and pull requests
# Docs: https://github.com/actions/stale

name: Stale Issues & PRs

on:
  schedule:
    - cron: '31 10 * * *'  # Daily at 10:31 UTC
  workflow_dispatch:

# Prevent overlapping runs
concurrency:
  group: stale-issues
  cancel-in-progress: true

jobs:
  stale:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    permissions:
      issues: write
      pull-requests: write

    steps:
    - uses: actions/stale@v10
      with:
        repo-token: ${{ secrets.GITHUB_TOKEN }}
        
        # Issues configuration
        days-before-issue-stale: 60
        days-before-issue-close: 14
        stale-issue-label: 'stale'
        stale-issue-message: |
          This issue has been automatically marked as stale because it has not had 
          recent activity. It will be closed in 14 days if no further activity occurs.
          
          If this is still relevant, please:
          - Comment with an update
          - Remove the 'stale' label
          - Add more context or information
          
          Thank you for your contributions!
        close-issue-message: |
          This issue has been automatically closed due to inactivity.
          Feel free to reopen if this is still relevant.
        
        # PRs configuration
        days-before-pr-stale: 30
        days-before-pr-close: 7
        stale-pr-label: 'stale'
        stale-pr-message: |
          This PR has been automatically marked as stale because it has not had 
          recent activity. It will be closed in 7 days if no further activity occurs.
          
          If this is still relevant, please:
          - Rebase on the latest main branch
          - Address any review comments
          - Remove the 'stale' label
        close-pr-message: |
          This PR has been automatically closed due to inactivity.
          Feel free to reopen or create a new PR if this is still relevant.
        
        # Exemptions
        exempt-issue-labels: 'pinned,security,bug,enhancement'
        exempt-pr-labels: 'pinned,work-in-progress,blocked'
        exempt-all-milestones: true
        
        # Operations per run
        operations-per-run: 30
