/* Typography Utilities */
/* Use these utility classes to apply consistent typography across the site */

/* Sans-serif (Geist Sans) - Default */
.font-sans {
  font-family: var(--font-geist-sans), ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
}

/* Serif for headings, quotes, and emphasis */
.font-serif {
  font-family: var(--font-serif), ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
}

/* Monospace (Geist Mono) - For code */
.font-mono {
  font-family: var(--font-geist-mono), ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, "Liberation Mono", monospace;
}

/* Prose typography improvements */
.prose h1,
.prose h2 {
  font-family: var(--font-serif), ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
  font-weight: 700;
  line-height: 1.3;
  margin-top: 3rem;
  margin-bottom: 1.25rem;
  letter-spacing: -0.5px;
}

.prose h3,
.prose h4 {
  margin-top: 2rem;
  margin-bottom: 1rem;
  letter-spacing: -0.3px;
}

/* Remove top margin from first heading to prevent extra spacing at top of page */
.prose > h1:first-child,
.prose > h2:first-child,
.prose > h3:first-child {
  margin-top: 0;
}

.prose blockquote {
  font-style: italic;
  font-weight: bold;
}

.prose code,
.prose pre {
  font-family: var(--font-geist-mono), ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, "Liberation Mono", monospace;
}

/* Inline code styling - Monochrome */
.prose code:not(pre code) {
  font-size: 0.875rem;
  padding: 0.2em 0.4em;
  background-color: hsl(var(--muted));
  border: 1px solid hsl(var(--border));
  box-shadow: inset 0 1px 2px hsl(0 0% 10% / 0.05);
  border-radius: 0.375rem;
  color: hsl(var(--foreground));
  word-break: break-word;
  overflow-wrap: break-word;
  transition: background-color var(--duration-fast) var(--ease-default),
    border-color var(--duration-fast) var(--ease-default);
}

.dark .prose code:not(pre code) {
  background-color: hsl(var(--muted));
  border-color: hsl(var(--border));
  color: hsl(var(--foreground));
  /* Subtle monochrome shadow */
  box-shadow: inset 0 1px 2px hsl(0 0% 10% / 0.05);
}

.prose p {
  line-height: 1.75;
  letter-spacing: 0.2px;
  margin-bottom: clamp(1.25rem, 1rem + 1vw, 1.75rem);
  word-spacing: 0.05em;
  text-rendering: optimizeLegibility;
  max-width: clamp(65ch, 70ch, 75ch);
}

/* Exclude banners and alerts from prose paragraph styling */
.alert-banner p,
.banner p,
.prose-banner p,
[data-type="banner"] p,
[role="alert"] p,
[role="note"] p {
  max-width: none !important;
  margin-bottom: 0 !important;
}

/* Remove paragraph margins within figures */
figure p,
figcaption p {
  margin-bottom: 0 !important;
}

/* ===================================================================
   RESPONSIVE TYPOGRAPHY SYSTEM
   ================================================================ */

/* Mobile-first fluid typography (320px - 768px) */
@media (max-width: 48rem) {
  .prose {
    font-size: clamp(1rem, 0.9rem + 0.5vw, 1.0625rem);
    /* 16px - 17px */
  }

  .prose p {
    line-height: clamp(1.75, 1.7 + 0.25vw, 1.8);
    letter-spacing: clamp(0.2px, 0.2px + 0.05vw, 0.3px);
    word-spacing: clamp(0.05em, 0.05em + 0.015vw, 0.08em);
  }

  /* Mobile headings with fluid scaling */
  .prose h2 {
    font-size: clamp(1.5rem, 1.25rem + 1.25vw, 1.75rem);
    /* 24px - 28px */
    margin-top: clamp(2.5rem, 2rem + 2.5vw, 3.5rem);
    margin-bottom: clamp(1rem, 0.75rem + 1.25vw, 1.5rem);
  }

  .prose h3 {
    font-size: clamp(1.25rem, 1.125rem + 0.625vw, 1.375rem);
    /* 20px - 22px */
    margin-top: clamp(2rem, 1.75rem + 1.25vw, 2.75rem);
    margin-bottom: clamp(0.875rem, 0.75rem + 0.625vw, 1.25rem);
  }

  .prose h4 {
    font-size: clamp(1.125rem, 1rem + 0.625vw, 1.25rem);
    /* 18px - 20px */
    margin-top: clamp(1.75rem, 1.5rem + 1.25vw, 2rem);
    margin-bottom: clamp(0.75rem, 0.5rem + 1.25vw, 1rem);
  }

  /* Mobile code blocks */
  .prose pre {
    font-size: clamp(0.75rem, 0.7rem + 0.25vw, 0.8125rem);
    /* 12px - 13px */
    padding: clamp(0.625rem, 0.5rem + 0.625vw, 0.75rem);
    margin-left: -1rem;
    margin-right: -1rem;
    border-radius: 0;
    overflow-x: auto;
  }

  .prose code {
    font-size: clamp(0.8125rem, 0.75rem + 0.3125vw, 0.875rem);
  }

  /* Mobile blockquotes */
  .prose blockquote {
    margin-top: clamp(1.25rem, 1rem + 1.25vw, 1.5rem);
    margin-bottom: clamp(1.25rem, 1rem + 1.25vw, 1.5rem);
    padding-left: clamp(0.75rem, 0.625rem + 0.625vw, 1rem);
  }
}

/* Details/Summary (Collapsible FAQ) Styling */
.prose details {
  margin-top: 1rem;
  margin-bottom: 1rem;
  border: 1px solid hsl(var(--border));
  border-radius: 0.5rem;
  padding: 1rem;
  background: hsl(var(--card));
}

.prose details summary {
  cursor: pointer;
  font-weight: bold !important;
  font-size: 1rem !important;
  list-style: none;
  user-select: none;
  display: flex;
  align-items: center;
}

.prose details summary::-webkit-details-marker {
  display: none;
}

.prose details summary::before {
  content: 'â–¶';
  margin-right: 0.5rem;
  transition: transform 0.2s ease;
  display: inline-block;
}

.prose details[open] summary::before {
  transform: rotate(90deg);
}

.prose details > *:not(summary) {
  margin-left: 1.5rem;
  margin-top: 0.75rem;
}

.prose details > summary + * {
  margin-top: 1rem;
}

/* Tablet/desktop fluid typography (769px - 1199px) */
@media (min-width: 48.0625rem) and (max-width: 74.9375rem) {
  .prose {
    font-size: clamp(1.0625rem, 1rem + 0.3125vw, 1.125rem);
    /* 17px - 18px */
    line-height: clamp(1.8, 1.75 + 0.25vw, 1.9);
  }

  .prose p {
    line-height: clamp(1.8, 1.75 + 0.25vw, 1.85);
    letter-spacing: 0.2px;
    max-width: clamp(70ch, 72ch, 75ch);
  }

  /* Exclude banners from max-width constraints */
  .alert-banner p,
  .banner p,
  .prose-banner p,
  [data-type="banner"] p {
    max-width: none !important;
  }

  /* Tablet heading scaling */
  .prose h2 {
    font-size: clamp(1.75rem, 1.5rem + 1.25vw, 2rem);
    /* 28px - 32px */
    margin-top: clamp(2.75rem, 2.5rem + 1.25vw, 3rem);
    margin-bottom: clamp(1rem, 0.875rem + 0.625vw, 1.125rem);
  }

  .prose h3 {
    font-size: clamp(1.375rem, 1.25rem + 0.625vw, 1.5rem);
    /* 22px - 24px */
    margin-top: clamp(2.25rem, 2rem + 1.25vw, 2.5rem);
    margin-bottom: clamp(0.875rem, 0.75rem + 0.625vw, 1rem);
  }

  .prose h4 {
    font-size: clamp(1.25rem, 1.125rem + 0.625vw, 1.375rem);
    /* 20px - 22px */
    margin-top: clamp(1.75rem, 1.5rem + 1.25vw, 2rem);
    margin-bottom: clamp(0.625rem, 0.5rem + 0.625vw, 0.75rem);
  }

  /* Tablet blockquotes */
  .prose blockquote {
    margin-top: clamp(1.75rem, 1.5rem + 1.25vw, 2rem);
    margin-bottom: clamp(1.75rem, 1.5rem + 1.25vw, 2rem);
    padding-left: clamp(1rem, 0.875rem + 0.625vw, 1.25rem);
    line-height: clamp(1.7, 1.65 + 0.25vw, 1.8);
  }

  .prose blockquote p {
    font-size: clamp(1.0625rem, 1rem + 0.3125vw, 1.125rem);
    line-height: clamp(1.65, 1.6 + 0.25vw, 1.7);
    margin-bottom: clamp(0.375rem, 0.25rem + 0.625vw, 0.5rem);
    font-style: italic;
  }

  /* Tablet tables */
  .prose table {
    margin-top: clamp(1.25rem, 1rem + 1.25vw, 1.5rem);
    margin-bottom: clamp(1.25rem, 1rem + 1.25vw, 1.5rem);
  }

  .prose thead th {
    padding: clamp(0.625rem, 0.5rem + 0.625vw, 0.75rem) clamp(0.875rem, 0.75rem + 0.625vw, 1rem);
    line-height: 1.5;
    background-color: hsl(var(--muted));
  }

  .prose tbody td {
    padding: clamp(0.625rem, 0.5rem + 0.625vw, 0.75rem) clamp(0.875rem, 0.75rem + 0.625vw, 1rem);
    line-height: 1.6;
  }
}

/* Large desktop fluid typography (1200px+) */
@media (min-width: 75rem) {
  .prose {
    font-size: clamp(1.125rem, 1.0625rem + 0.3125vw, 1.25rem);
    /* 18px - 20px */
    line-height: clamp(1.75, 1.7 + 0.25vw, 1.8);
  }

  .prose p {
    max-width: clamp(65ch, 68ch, 70ch);
    /* Optimal reading length */
  }

  /* Exclude banners from max-width constraints */
  .alert-banner p,
  .banner p,
  .prose-banner p,
  [data-type="banner"] p {
    max-width: none !important;
  }

  /* Large desktop headings */
  .prose h2 {
    font-size: clamp(2rem, 1.75rem + 1.25vw, 2.25rem);
    /* 32px - 36px */
    margin-top: clamp(2.25rem, 2rem + 1.25vw, 2.5rem);
    margin-bottom: clamp(0.75rem, 0.625rem + 0.625vw, 0.875rem);
  }

  .prose h3 {
    font-size: clamp(1.5rem, 1.375rem + 0.625vw, 1.625rem);
    /* 24px - 26px */
    margin-top: clamp(1.75rem, 1.5rem + 1.25vw, 2rem);
    margin-bottom: clamp(0.625rem, 0.5rem + 0.625vw, 0.75rem);
  }

  .prose h4 {
    font-size: clamp(1.375rem, 1.25rem + 0.625vw, 1.5rem);
    /* 22px - 24px */
    margin-top: clamp(1.5rem, 1.375rem + 0.625vw, 1.75rem);
    margin-bottom: clamp(0.5rem, 0.375rem + 0.625vw, 0.625rem);
  }

  /* Large desktop blockquotes */
  .prose blockquote {
    margin-top: clamp(1.5rem, 1.375rem + 0.625vw, 1.75rem);
    margin-bottom: clamp(1.5rem, 1.375rem + 0.625vw, 1.75rem);
    padding-left: clamp(1.25rem, 1.125rem + 0.625vw, 1.5rem);
  }

  .prose blockquote p {
    font-size: clamp(1.125rem, 1.0625rem + 0.3125vw, 1.25rem);
  }

  /* Large desktop code blocks */
  .prose pre {
    margin-top: clamp(1.25rem, 1.125rem + 0.625vw, 1.5rem);
    margin-bottom: clamp(1.25rem, 1.125rem + 0.625vw, 1.5rem);
  }

  /* Large desktop horizontal rules */
  .prose hr {
    margin-top: clamp(2.25rem, 2rem + 1.25vw, 2.5rem);
    margin-bottom: clamp(2.25rem, 2rem + 1.25vw, 2.5rem);
    opacity: 0.5;
  }
}

/* ===================================================================
   MODERN TABLE STYLING SYSTEM
   
   Features:
   - Rounded corners following card design patterns
   - Subtle depth with shadows and hover effects
   - Figure caption support for table descriptions
   - Responsive overflow handling with horizontal scroll
   - Design token integration (SPACING, TYPOGRAPHY)
   - Dark/light mode support with semantic colors
   ================================================================ */

/* Table figure wrapper - card-like presentation */
.prose figure[role="table"] {
  position: relative;
  display: block;
  margin: 2rem auto;
  width: 100%;
}

/* Table container with modern styling */
.prose figure[role="table"] > div {
  position: relative;
  border-radius: 0.75rem;
  border: 1px solid hsl(var(--border));
  background-color: hsl(var(--card));
  /* Tier 2 shadow: Data content (medium prominence) */
  box-shadow: 0 1px 4px rgb(0 0 0 / 0.08);
  transition: box-shadow 200ms cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
}

.dark .prose figure[role="table"] > div {
  border-color: hsl(var(--border));
  /* Tier 2 shadow: Dark mode */
  box-shadow: 0 1px 4px rgb(0 0 0 / 0.2);
}

/* Hover effect for table depth */
.prose figure[role="table"]:hover > div {
  /* Tier 2 hover: Enhanced depth on interaction */
  box-shadow: 0 4px 12px rgb(0 0 0 / 0.12);
}

.dark .prose figure[role="table"]:hover > div {
  box-shadow: 0 4px 12px rgb(0 0 0 / 0.25);
}

/* Responsive table overflow handling */
.prose figure[role="table"] > div > .overflow-x-auto {
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
}

/* Scrollbar styling for better appearance */
.prose figure[role="table"] > div > .overflow-x-auto::-webkit-scrollbar {
  height: 0.375rem;
}

.prose figure[role="table"] > div > .overflow-x-auto::-webkit-scrollbar-track {
  background-color: hsl(var(--muted) / 30%);
  border-radius: 999px;
}

.prose figure[role="table"] > div > .overflow-x-auto::-webkit-scrollbar-thumb {
  background-color: hsl(var(--muted));
  border-radius: 999px;
  transition: background-color 200ms ease;
}

.prose figure[role="table"] > div > .overflow-x-auto::-webkit-scrollbar-thumb:hover {
  background-color: hsl(var(--muted) / 80%);
}

/* Modern table structure */
.prose table {
  width: 100%;
  border-collapse: collapse;
  margin: 0;
}

/* Table header with solid background for visibility */
.prose thead {
  background-color: hsl(var(--muted));
}

/* Table header cells with improved spacing and typography */
.prose thead th {
  padding: 1rem 1rem;
  text-align: left;
  font-weight: 700;
  font-size: 0.875rem;
  letter-spacing: 0.05em;
  text-transform: none;
  color: hsl(var(--foreground));
  border: 0;
  white-space: nowrap;
}

/* Table body rows with hover effect */
.prose tbody tr {
  border-bottom: 1px solid hsl(var(--border));
  transition: background-color 150ms cubic-bezier(0.4, 0, 0.2, 1);
}

.dark .prose tbody tr {
  border-bottom-color: hsl(var(--border));
}

.prose tbody tr:hover {
  background-color: hsl(var(--muted) / 50%);
}

.prose tbody tr:last-child {
  border-bottom: 0;
}

/* Table data cells with modern spacing */
.prose tbody td {
  padding: 1rem 1rem;
  text-align: left;
  font-size: 0.9375rem;
  line-height: 1.6;
  color: hsl(var(--foreground));
  border: 0;
  vertical-align: middle;
}

/* Striped rows for better readability (optional alternating pattern) */
.prose tbody tr:nth-child(odd) {
  background-color: hsl(var(--muted) / 25%);
}

.prose tbody tr:nth-child(odd):hover {
  background-color: hsl(var(--muted) / 50%);
}

/* Table caption styling */
.prose figcaption {
  margin-top: 0.75rem;
  padding: 0.75rem 1rem;
  text-align: center;
  font-size: 0.875rem;
  color: hsl(var(--foreground) / 80%);
  font-weight: 500;
  border-top: 1px solid hsl(var(--border));
  background-color: hsl(var(--muted) / 30%);
  border-bottom-left-radius: 0.75rem;
  border-bottom-right-radius: 0.75rem;
}

.dark .prose figcaption {
  border-top-color: hsl(var(--border));
}

/* Code in table cells */
.prose tbody td code,
.prose thead th code {
  background-color: hsl(var(--primary) / 10%);
  border: 1px solid hsl(var(--primary) / 20%);
  color: hsl(var(--primary));
  padding: 0.2em 0.4em;
  border-radius: 0.25rem;
  font-size: 0.85em;
  word-break: break-word;
}

/* Links in table cells */
.prose tbody a,
.prose thead a {
  color: hsl(var(--primary));
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: 0.25em;
  transition: color 150ms ease, background-color 150ms ease;
}

.prose tbody a:hover,
.prose thead a:hover {
  color: hsl(var(--primary) / 80%);
  text-decoration-thickness: 2px;
}

/* Responsive table adjustments for mobile */
@media (max-width: 48rem) {
  .prose figure[role="table"] {
    margin: 1.5rem -1rem;
    width: calc(100% + 2rem);
  }

  .prose figure[role="table"] > div {
    border-radius: 0.5rem;
  }

  .prose thead th {
    padding: 0.75rem 0.5rem;
    font-size: 0.8125rem;
  }

  .prose tbody td {
    padding: 0.75rem 0.5rem;
    font-size: 0.875rem;
  }

  .prose figcaption {
    padding: 0.5rem 0.5rem;
    font-size: 0.8125rem;
  }
}

/* ===================================================================
   UNIFIED LIST SYSTEM
   ================================================================ */

/* Base list styles with fluid scaling */
.prose ul,
.prose ol {
  margin-top: clamp(1rem, 0.875rem + 0.625vw, 1.25rem);
  margin-bottom: clamp(1rem, 0.875rem + 0.625vw, 1.25rem);
  padding-left: clamp(1.25rem, 1.125rem + 0.625vw, 1.5rem);
  list-style-position: outside;
}

.prose ol {
  /* Ensure consistent margin for ordered lists */
  margin-left: 0;
}

.prose li {
  margin-top: clamp(0.375rem, 0.25rem + 0.625vw, 0.5rem);
  margin-bottom: clamp(0.375rem, 0.25rem + 0.625vw, 0.5rem);
  line-height: 1.6;
  /* Consistent across all breakpoints */
}

/* Inline code in lists */
.prose li code {
  margin: 0 0.25em;
}

/* Reduce spacing between paragraphs and lists */
.prose p + ul,
.prose p + ol {
  margin-top: clamp(0.25rem, 0.125rem + 0.625vw, 0.5rem);
}

/* Typography enhancements that apply to all breakpoints */
.prose strong {
  font-weight: 600;
}

.prose em {
  font-style: italic;
}

/* ===================================================================
   PROSE LINK STYLING - Modern, Accessible Design
   ================================================================ */

/**
 * Philosophy:
 * 1. Links must be clearly distinguishable from body text (WCAG 2.1 AA)
 * 2. Smooth, professional transitions matching site aesthetic
 * 3. Subtle hover feedback without being jarring
 * 4. Consistent with design token system
 * 
 * Color Strategy:
 * - Light mode: Use primary (near-black) with medium opacity for subtle distinction
 * - Dark mode: Use foreground with slight boost for better visibility
 * - Hover: Reduce opacity for elegant fade effect (matches modern UI patterns)
 */

/* Default link styling - Clean, underlined, accessible */
.prose a:not(h1 a, h2 a, h3 a, h4 a, h5 a, h6 a),
.prose a:link:not(h1 a, h2 a, h3 a, h4 a, h5 a, h6 a),
.prose a:visited:not(h1 a, h2 a, h3 a, h4 a, h5 a, h6 a) {
  /* Color: Slightly lighter than body text for distinction */
  color: hsl(var(--foreground) / 0.85) !important;

  /* Underline: Solid, continuous, properly offset */
  text-decoration: underline !important;
  text-decoration-thickness: 1px !important;
  text-underline-offset: 0.25em !important;
  text-decoration-skip-ink: none !important;

  /* Smooth transitions using design tokens */
  transition: color var(--duration-fast) var(--ease-default),
    text-decoration-color var(--duration-fast) var(--ease-default),
    text-decoration-thickness var(--duration-fast) var(--ease-default);

  /* Performance optimization */
  will-change: auto;
}

/* Hover state - Elegant fade with thicker underline */
.prose a:hover:not(h1 a, h2 a, h3 a, h4 a, h5 a, h6 a) {
  color: hsl(var(--foreground) / 0.65) !important;
  text-decoration-thickness: 1.5px !important;
  text-decoration-color: hsl(var(--foreground) / 0.5) !important;
}

/* Active state - Subtle press feedback */
.prose a:active:not(h1 a, h2 a, h3 a, h4 a, h5 a, h6 a) {
  color: hsl(var(--foreground) / 0.55) !important;
  transition-duration: 50ms;
}

/* Focus state - Accessible keyboard navigation */
.prose a:focus-visible {
  outline: 2px solid hsl(var(--ring)) !important;
  outline-offset: 3px;
  border-radius: 2px;
}

/* Dark mode adjustments - Enhanced visibility */
.dark .prose a:not(h1 a, h2 a, h3 a, h4 a, h5 a, h6 a),
.dark .prose a:link:not(h1 a, h2 a, h3 a, h4 a, h5 a, h6 a),
.dark .prose a:visited:not(h1 a, h2 a, h3 a, h4 a, h5 a, h6 a) {
  color: hsl(var(--foreground) / 0.9) !important;
}

.dark .prose a:hover:not(h1 a, h2 a, h3 a, h4 a, h5 a, h6 a) {
  color: hsl(var(--foreground) / 0.7) !important;
  text-decoration-color: hsl(var(--foreground) / 0.6) !important;
}

/* Header links - Remove underline decoration with high specificity */
.prose h1 > a,
.prose h2 > a,
.prose h3 > a,
.prose h4 > a,
.prose h5 > a,
.prose h6 > a,
.prose h1 a,
.prose h2 a,
.prose h3 a,
.prose h4 a,
.prose h5 a,
.prose h6 a {
  text-decoration: none !important;
}

.prose h1 > a:hover,
.prose h2 > a:hover,
.prose h3 > a:hover,
.prose h4 > a:hover,
.prose h5 > a:hover,
.prose h6 > a:hover,
.prose h1 a:hover,
.prose h2 a:hover,
.prose h3 a:hover,
.prose h4 a:hover,
.prose h5 a:hover,
.prose h6 a:hover {
  text-decoration: none !important;
}